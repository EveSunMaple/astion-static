---
import type { Post } from "../../utils/interfaces";
import { getPostById, shuoshuos } from "../../services/data";
import BaseLayout from "../../layout/BaseLayout.astro";
import PostCard from "../../components/PostCard.astro";

export async function getStaticPaths() {
  return shuoshuos.map((shuoshuo) => ({
    params: { slug: shuoshuo.id },
  }));
}

const { slug } = Astro.params;

let shuoshuo: Post | undefined;
if (typeof slug === "string") {
  shuoshuo = getPostById(slug);
}

if (!shuoshuo) {
  throw new Error("Post not found");
}

const { title, blocks, pubDate } = shuoshuo;
---

<BaseLayout title={title}>
  <PostCard title={title} block={blocks} pubDate={pubDate} />
</BaseLayout>
